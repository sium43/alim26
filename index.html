<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alim 26 Topper's Roadmap Pro Batch (BOM)</title>
  <style>
    /* =========================
    CSS STYLES
    ========================= */
    :root{
      --bg:#0d1117;
      --card:rgba(255,255,255,0.06);
      --card2:rgba(255,255,255,0.08);
      --text:#e6edf3;
      --muted:#9ba3af;
      --accent1:#22d3ee;
      --accent2:#10b981;
      --border:#273043;
      --pinned-bg: rgba(34, 211, 238, 0.1);
      --pinned-border: rgba(34, 211, 238, 0.3);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    a{color:inherit;text-decoration:none}
    .container{max-width:1100px;margin:0 auto;padding:20px}
    header{
      position:sticky;top:0;z-index:50;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(13,17,23,0.85), rgba(13,17,23,0.6));
      border-bottom:1px solid var(--border);
    }
    .nav{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:14px 20px}
    .brand{font-weight:800;letter-spacing:.3px}
    .tag{opacity:.85;font-weight:600;background:linear-gradient(90deg,var(--accent1),var(--accent2));-webkit-background-clip:text;background-clip:text;color:transparent}
    .searchbar{display:flex;gap:10px;align-items:center;width:100%;max-width:520px}
    .searchbar input, select{
      width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:var(--card2);color:var(--text);outline:none;
    }
    .grid{
      display:grid;gap:16px;
      grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
      margin-top:18px;
    }
    .card{
      background:var(--card);border:1px solid var(--border);
      border-radius:16px;padding:16px;backdrop-filter: blur(12px);
      transition:transform .2s, border-color .2s;
    }
    .card:hover{transform:translateY(-4px);border-color:#2b5cff}
    .card.pinned {
      background: var(--pinned-bg);
      border: 2px solid var(--pinned-border);
      position: relative;
    }
    .card.pinned::before {
      content: "ржЖржЬржХрзЗрж░ ржХрзНрж▓рж╛рж╕";
      position: absolute;
      top: -10px;
      right: 12px;
      background: linear-gradient(90deg,var(--accent1),var(--accent2));
      color: #001015;
      font-weight: bold;
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 20px;
    }
    .subject{font-weight:700;margin-bottom:8px;color:#7ecbff}
    .time{color:var(--muted);font-size:.95rem;margin-bottom:12px}
    .btn{display:inline-block;padding:10px 14px;border-radius:12px;border:1px solid transparent;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#001015;font-weight:700}
    .btn:focus,.btn:hover{filter:brightness(1.05)}
    .subj-list{display:grid;gap:12px;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));margin-top:18px}
    .pill{
      background:var(--card);border:1px solid var(--border);border-radius:999px;padding:12px 14px;display:flex;justify-content:space-between;align-items:center;gap:10px
    }
    .pill .go{padding:8px 12px;border-radius:999px;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#001015;font-weight:700}
    footer{opacity:.7;margin:24px 0;text-align:center;font-size:.9rem}
    .controls{display:flex;gap:10px;align-items:center;margin-top:10px}
    .back-btn {display: inline-block; margin-bottom: 20px; padding: 8px 16px; background: var(--card); border-radius: 8px;}
    .section-title {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 30px;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border);
    }
    .section-title::before {
      content: "";
      display: block;
      width: 4px;
      height: 24px;
      background: linear-gradient(180deg,var(--accent1),var(--accent2));
      border-radius: 4px;
    }
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--muted);
    }
    .empty-state svg {
      width: 64px;
      height: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: var(--accent1);
      animation: spin 1s ease-in-out infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 12px 20px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 1000;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s, transform 0.3s;
    }
    .notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    .notification.error {
      border-left: 4px solid #ff4757;
    }
    .notification.success {
      border-left: 4px solid var(--accent2);
    }
    .card .video-title {
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 12px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <!-- ржорзЗржЗржи ржЗржиржбрзЗржХрзНрж╕ ржкрзГрж╖рзНржарж╛ -->
  <div id="main-page">
    <header>
      <nav class="nav container">
        <div class="brand">Alim 26 <span class="tag">Topper's Roadmap Pro (BOM)</span></div>
        <div class="searchbar">
          <input id="search-subjects" type="search" placeholder="ЁЯФН рж╕рж╛ржмржЬрзЗржХрзНржЯ ржЦрзБржБржЬрзБржи...">
        </div>
      </nav>
    </header>

    <main class="container">
      <!-- ржЖржЬржХрзЗрж░ ржХрзНрж▓рж╛рж╕ рж╕рзЗржХрж╢ржи -->
      <div class="section-title">
        <h2>ржЖржЬржХрзЗрж░ ржХрзНрж▓рж╛рж╕</h2>
      </div>
      <div id="today-classes" class="grid">
        <div class="empty-state">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <p>ржЖржЬржХрзЗрж░ ржЬржирзНржп ржХрзЛржи ржХрзНрж▓рж╛рж╕ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐</p>
        </div>
      </div>

      <!-- рж╕ржХрж▓ рж╕рж╛ржмржЬрзЗржХрзНржЯ рж╕рзЗржХрж╢ржи -->
      <div class="section-title">
        <h2>рж╕ржм рж╕рж╛ржмржЬрзЗржХрзНржЯ</h2>
      </div>
      <div class="subj-list">
        <a class="pill subject-link" href="#" data-name="ржХрзБрж░ржЖржи ржорж╛ржЬрзАржж"><span>ЁЯУШ ржХрзБрж░ржЖржи ржорж╛ржЬрзАржж</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="рж╣рж╛ржжрзАрж╕ ржУ ржЙрж╕рзВрж▓рзБрж▓ рж╣рж╛ржжрзАрж╕"><span>ЁЯУШ рж╣рж╛ржжрзАрж╕ ржУ ржЙрж╕рзВрж▓рзБрж▓ рж╣рж╛ржжрзАрж╕</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЖрж▓ ржлрж┐ржХрж╣ ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржЖрж▓ ржлрж┐ржХрж╣ ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЖрж▓ ржлрж┐ржХрж╣ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржЖрж▓ ржлрж┐ржХрж╣ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЖрж░ржмрж┐ ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржЖрж░ржмрж┐ ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЖрж░ржмрж┐ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржЖрж░ржмрж┐ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЖрж░ржмрж┐ рж╕рж╛рж╣рж┐рждрзНржп"><span>ЁЯУШ ржЖрж░ржмрж┐ рж╕рж╛рж╣рж┐рждрзНржп</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржмрж╛рж▓рж╛ржЧрж╛ржд ржУ ржорж╛ржирждрж┐ржХ"><span>ЁЯУШ ржмрж╛рж▓рж╛ржЧрж╛ржд ржУ ржорж╛ржирждрж┐ржХ</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржмрж╛ржВрж▓рж╛ ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржмрж╛ржВрж▓рж╛ ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржмрж╛ржВрж▓рж╛ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржмрж╛ржВрж▓рж╛ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЗржВрж░рзЗржЬрж┐ ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржЗржВрж░рзЗржЬрж┐ ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЗржВрж░рзЗржЬрж┐ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржЗржВрж░рзЗржЬрж┐ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЗрж╕рж▓рж╛ржорзЗрж░ ржЗрждрж┐рж╣рж╛рж╕"><span>ЁЯУШ ржЗрж╕рж▓рж╛ржорзЗрж░ ржЗрждрж┐рж╣рж╛рж╕</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="рждржерзНржп ржУ ржпрзЛржЧрж╛ржпрзЛржЧ ржкрзНрж░ржпрзБржХрзНрждрж┐"><span>ЁЯУШ рждржерзНржп ржУ ржпрзЛржЧрж╛ржпрзЛржЧ ржкрзНрж░ржпрзБржХрзНрждрж┐</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржкржжрж╛рж░рзНржержмрж┐ржЬрзНржЮрж╛ржи ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржкржжрж╛рж░рзНржержмрж┐ржЬрзНржЮрж╛ржи ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржкржжрж╛рж░рзНржержмрж┐ржЬрзНржЮрж╛ржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржкржжрж╛рж░рзНржержмрж┐ржЬрзНржЮрж╛ржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="рж░рж╕рж╛рзЯржи ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ рж░рж╕рж╛рзЯржи ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="рж░рж╕рж╛рзЯржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ рж░рж╕рж╛рзЯржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЬрзАржмржмрж┐ржЬрзНржЮрж╛ржи ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржЬрзАржмржмрж┐ржЬрзНржЮрж╛ржи ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЬрзАржмржмрж┐ржЬрзНржЮрж╛ржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржЬрзАржмржмрж┐ржЬрзНржЮрж╛ржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЕрж░рзНржержирзАрждрж┐ ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржЕрж░рзНржержирзАрждрж┐ ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЕрж░рзНржержирзАрждрж┐ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржЕрж░рзНржержирзАрждрж┐ ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржкрзМрж░ржирзАрждрж┐ ржУ рж╕рзБрж╢рж╛рж╕ржи ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржкрзМрж░ржирзАрждрж┐ ржУ рж╕рзБрж╢рж╛рж╕ржи ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржкрзМрж░ржирзАрждрж┐ ржУ рж╕рзБрж╢рж╛рж╕ржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржкрзМрж░ржирзАрждрж┐ ржУ рж╕рзБрж╢рж╛рж╕ржи ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЙржЪрзНржЪрждрж░ ржЧржгрж┐ржд ржкрзНрж░ржержо ржкрждрзНрж░"><span>ЁЯУШ ржЙржЪрзНржЪрждрж░ ржЧржгрж┐ржд ржкрзНрж░ржержо ржкрждрзНрж░</span><span class="go">Open</span></a>
        <a class="pill subject-link" href="#" data-name="ржЙржЪрзНржЪрждрж░ ржЧржгрж┐ржд ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░"><span>ЁЯУШ ржЙржЪрзНржЪрждрж░ ржЧржгрж┐ржд ржжрзНржмрж┐рждрзАрзЯ ржкрждрзНрж░</span><span class="go">Open</span></a>
      </div>
    </main>

    <footer>┬й Alim 26 Topper's Roadmap Pro Batch (BOM)</footer>
  </div>

  <!-- рж╕рж╛ржмржЬрзЗржХрзНржЯ ржкрзГрж╖рзНржарж╛ (ржкрзНрж░ржержорзЗ рж▓рзБржХрж╛ржирзЛ) -->
  <div id="subject-page" style="display: none;">
    <header>
      <nav class="nav container">
        <a class="brand back-button" href="#">тЖР All Subjects</a>
        <div class="controls">
          <input id="search" type="search" placeholder="ЁЯФН рж╕рж╛рж░рзНржЪ...">
          <select id="sort">
            <option value="desc">ржирждрзБржи ржерзЗржХрзЗ ржкрзБрж░рж╛ржирзЛ</option>
            <option value="asc">ржкрзБрж░рж╛ржирзЛ ржерзЗржХрзЗ ржирждрзБржи</option>
          </select>
        </div>
      </nav>
    </header>
    <main class="container">
      <h2 id="subject-title">ЁЯУШ рж╕рж╛ржмржЬрзЗржХрзНржЯ</h2>
      <div id="classGrid" class="grid"></div>
    </main>
    <footer>┬й Alim 26 Topper's Roadmap Pro Batch (BOM)</footer>
  </div>

  <div id="notification" class="notification"></div>

  <script>
    // =========================
    // JavaScript ржХрзЛржб - Google Sheets рж╕ржВржпрзЛржЧ рж╕рж╣
    // =========================
    
    // ржЖржкржирж╛рж░ Google Apps Script Web App URL
    const API_URL = "https://script.google.com/macros/s/AKfycbwuCA_GM1XjkheZ-WNQH49xkSo-dBcm6RXstKi63fB6EDj9zOCS_h8wrcxb4lJ2unTu/exec";
    
    // DOM рж╣рзЗрж▓рзНржкрж╛рж░ ржлрж╛ржВрж╢ржи
    function $(sel, root=document){ return root.querySelector(sel); }
    function $all(sel, root=document){ return Array.from(root.querySelectorAll(sel)); }

    // ржкрзЗржЬ рж╕рзНржЯрзЗржЯ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ
    let currentSubject = null;
    const mainPage = $('#main-page');
    const subjectPage = $('#subject-page');
    let allClasses = [];

    // ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи ржжрзЗржЦрж╛ржирзЛрж░ ржлрж╛ржВрж╢ржи
    function showNotification(message, isError = false) {
      const notification = $('#notification');
      notification.textContent = message;
      notification.className = 'notification ' + (isError ? 'error' : 'success');
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    // рждрж╛рж░рж┐ржЦ ржлрж░ржорзНржпрж╛ржЯ ржХрж░рж╛
    function getTodayDate() {
      const today = new Date();
      const year = today.getFullYear();
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const day = String(today.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    // ржмрж╛ржВрж▓рж╛ ржорж╛рж╕рзЗрж░ ржирж╛ржо
    const banglaMonths = [
      'ржЬрж╛ржирзБржпрж╝рж╛рж░рзА', 'ржлрзЗржмрзНрж░рзБржпрж╝рж╛рж░рзА', 'ржорж╛рж░рзНржЪ', 'ржПржкрзНрж░рж┐рж▓', 'ржорзЗ', 'ржЬрзБржи',
      'ржЬрзБрж▓рж╛ржЗ', 'ржЖржЧрж╕рзНржЯ', 'рж╕рзЗржкрзНржЯрзЗржорзНржмрж░', 'ржЕржХрзНржЯрзЛржмрж░', 'ржиржнрзЗржорзНржмрж░', 'ржбрж┐рж╕рзЗржорзНржмрж░'
    ];

    // рждрж╛рж░рж┐ржЦ ржлрж░ржорзНржпрж╛ржЯ ржХрж░рж╛ (ржмрж╛ржВрж▓рж╛ ржлрж░ржорзНржпрж╛ржЯрзЗ)
    function formatDateToBangla(dateStr) {
      if (!dateStr) return '';
      
      try {
        const date = new Date(dateStr);
        if (isNaN(date)) return dateStr;
        
        const day = date.getDate();
        const month = banglaMonths[date.getMonth()];
        const year = date.getFullYear();
        
        return `${day} ${month}, ${year}`;
      } catch (error) {
        console.error("Date formatting error:", error, dateStr);
        return dateStr;
      }
    }

    // ржбрзЗржЯрж╛ ржлрзЗржЪ ржХрж░рж╛
    async function fetchData(){
      try {
        // CORS рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржирзЗрж░ ржЬржирзНржп proxy ржмрзНржпржмрж╣рж╛рж░
        const proxyUrl = 'https://corsproxy.io/?';
        const res = await fetch(proxyUrl + encodeURIComponent(API_URL));
        
        if (!res.ok) {
          throw new Error(`HTTP error! status: ${res.status}`);
        }
        
        const json = await res.json();
        showNotification("ржбрзЗржЯрж╛ рж╕ржлрж▓ржнрж╛ржмрзЗ рж▓рзЛржб рж╣ржпрж╝рзЗржЫрзЗ!");
        return json;
      } catch (error) {
        console.error("ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛:", error);
        showNotification("ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржЪрзНржЫрзЗ", true);
        return [];
      }
    }

    // ржбрзЗржЯрж╛ ржирж░ржорж╛рж▓рж╛ржЗржЬ ржХрж░рж╛
    function normalizeRow(row, index){
      // Google Sheets ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржирж░ржорж╛рж▓рж╛ржЗржЬ ржХрж░рж╛
      const subject = row['subject'] || row['рж╕рж╛ржмржЬрзЗржХрзНржЯ'] || row['Subject'] || '';
      const link = row['link'] || row['рж▓рж┐ржВржХ'] || row['Link'] || '';
      const title = row['title'] || row['ржнрж┐ржбрж┐ржУ ржЯрж╛ржЗржЯрзЗрж▓'] || row['Video Title'] || '';
      
      // рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ рждрж╛рж░рж┐ржЦ ржПржмржВ рж╕ржоржпрж╝ ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж╛
      const now = new Date();
      const pastDate = new Date();
      pastDate.setDate(now.getDate() - index);
      
      const date = getTodayDate();
      const time = `${(pastDate.getHours() % 12 || 12)}:${String(pastDate.getMinutes()).padStart(2, '0')} ${pastDate.getHours() >= 12 ? 'PM' : 'AM'}`;
      
      return { 
        subject: subject.trim(), 
        link: link.trim(), 
        title: title.trim(),
        date: date,
        time: time,
        serial: index + 1
      };
    }

    // ржХрж╛рж░рзНржб рж░рзЗржирзНржбрж╛рж░ ржХрж░рж╛
    function renderCards(rows, root, isPinned = false){
      if (rows.length === 0) {
        root.innerHTML = '<div class="empty-state"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><p>ржХрзЛржи ржХрзНрж▓рж╛рж╕ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐</p></div>';
        return;
      }
      
      root.innerHTML = '';
      rows.forEach(r => {
        const card = document.createElement('div');
        card.className = isPinned ? 'card pinned' : 'card';
        card.innerHTML = `
          <div class="subject">${r.subject || 'Unknown Subject'} <span style="font-size: 12px; color: var(--muted);">#${r.serial}</span></div>
          <div class="video-title">${r.title || 'ржХрзНрж▓рж╛рж╕ ржнрж┐ржбрж┐ржУ'}</div>
          <div class="time">тП░ ${r.time || ''} | ${formatDateToBangla(r.date) || ''}</div>
          <a class="btn" target="_blank" rel="noopener" href="${r.link || '#'}">Watch Now</a>
        `;
        root.appendChild(card);
      });
    }

    // ржЖржЬржХрзЗрж░ ржХрзНрж▓рж╛рж╕ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛
    function filterTodayClasses(classes) {
      const today = getTodayDate();
      return classes.filter(cls => cls.date === today);
    }

    // рж╕ржоржпрж╝ ржЕржирзБржпрж╛ржпрж╝рзА рж╕рж╛ржЬрж╛ржирзЛ
    function sortByTime(rows, order='desc'){
      return rows.slice().sort((a,b)=>{
        return order === 'asc' ? a.serial - b.serial : b.serial - a.serial;
      });
    }

    // рж╕рж╛ржмржЬрзЗржХрзНржЯ ржкрзГрж╖рзНржарж╛ ржжрзЗржЦрж╛ржирзЛ
    function showSubjectPage(subject) {
      currentSubject = subject;
      $('#subject-title').textContent = 'ЁЯУШ ' + subject;
      mainPage.style.display = 'none';
      subjectPage.style.display = 'block';
      loadSubjectData(subject);
    }

    // ржорзЗржЗржи ржкрзГрж╖рзНржарж╛ржпрж╝ ржлрж┐рж░рзЗ ржпрж╛ржУржпрж╝рж╛
    function showMainPage() {
      subjectPage.style.display = 'none';
      mainPage.style.display = 'block';
      currentSubject = null;
    }

    // рж╕рж╛ржмржЬрзЗржХрзНржЯ ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рж╛
    async function loadSubjectData(subject) {
      const grid = $('#classGrid');
      const searchInput = $('#search');
      const sortSelect = $('#sort');
      
      grid.innerHTML = '<div class="card"><div class="subject">рж▓рзЛржб рж╣ржЪрзНржЫрзЗ... <span class="loading"></span></div></div>';
      
      let rows = allClasses.filter(r => String(r.subject).trim() === subject);
      
      rows = sortByTime(rows, 'desc');
      renderCards(rows, grid);

      // рж╕рж╛рж░рзНржЪ ржлрж╛ржВрж╢ржирж╛рж▓рж┐ржЯрж┐
      searchInput.addEventListener('input', ()=>{
        const q = searchInput.value.toLowerCase();
        const filtered = rows.filter(r =>
          (r.subject||'').toLowerCase().includes(q) || 
          (r.title||'').toLowerCase().includes(q) ||
          (r.time||'').toLowerCase().includes(q) ||
          (r.date||'').toLowerCase().includes(q)
        );
        renderCards(filtered, grid);
      });

      // рж╕рж░рзНржЯ ржлрж╛ржВрж╢ржирж╛рж▓рж┐ржЯрж┐
      sortSelect.addEventListener('change', ()=>{
        const order = sortSelect.value;
        const sorted = sortByTime(rows, order);
        renderCards(sorted, grid);
      });
    }

    // ржЖржЬржХрзЗрж░ ржХрзНрж▓рж╛рж╕ рж▓рзЛржб ржХрж░рж╛
    function loadTodayClasses() {
      const todayContainer = $('#today-classes');
      const todayClasses = filterTodayClasses(allClasses);
      
      if (todayClasses.length > 0) {
        renderCards(todayClasses, todayContainer, true);
      } else {
        todayContainer.innerHTML = '<div class="empty-state"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><p>ржЖржЬржХрзЗрж░ ржЬржирзНржп ржХрзЛржи ржХрзНрж▓рж╛рж╕ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝ржирж┐</p></div>';
      }
    }

    // ржЗржнрзЗржирзНржЯ рж▓рж┐рж╕рзЗржирж╛рж░ рж╕рзЗржЯржЖржк
    function setupEventListeners() {
      // рж╕рж╛ржмржЬрзЗржХрзНржЯ рж▓рж┐ржЩрзНржХ ржХрзНрж▓рж┐ржХ
      $all('.subject-link').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const subject = link.getAttribute('data-name');
          showSubjectPage(subject);
        });
      });
      
      // ржмрзНржпрж╛ржХ ржмрж╛ржЯржи
      $('.back-button').addEventListener('click', (e) => {
        e.preventDefault();
        showMainPage();
      });
      
      // ржорзЗржЗржи ржкрзЗржЬ рж╕рж╛рж░рзНржЪ
      const searchInput = $('#search-subjects');
      if(searchInput) {
        searchInput.addEventListener('input', ()=>{
          const q = searchInput.value.trim().toLowerCase();
          $all('.pill').forEach(p=>{
            const name = p.dataset.name.toLowerCase();
            p.style.display = name.includes(q) ? '' : 'none';
          });
        });
      }
    }

    // ржкрзНрж░рж╛ржержорж┐ржХ ржбрзЗржЯрж╛ рж▓рзЛржб
    async function loadInitialData() {
      // рж▓рзЛржбрж┐ржВ рж╕рзНржЯрзЗржЯ ржжрзЗржЦрж╛ржи
      const todayContainer = $('#today-classes');
      todayContainer.innerHTML = '<div class="card"><div class="subject">ржбрзЗржЯрж╛ рж▓рзЛржб рж╣ржЪрзНржЫрзЗ... <span class="loading"></span></div></div>';
      
      const data = await fetchData();
      allClasses = data.map((row, index) => normalizeRow(row, index));
      
      // ржЖржЬржХрзЗрж░ ржХрзНрж▓рж╛рж╕ рж▓рзЛржб ржХрж░рзБржи
      loadTodayClasses();
    }

    // ржкрзЗржЬ рж▓рзЛржб рж╣рж▓рзЗ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬрзЗрж╢ржи
    document.addEventListener('DOMContentLoaded', ()=>{
      setupEventListeners();
      loadInitialData();
      
      // URL ржЪрзЗржХ ржХрж░рзЗ рж╕рж░рж╛рж╕рж░рж┐ рж╕рж╛ржмржЬрзЗржХрзНржЯ ржкрзЗржЬрзЗ ржпрж╛ржУржпрж╝рж╛рж░ ржЬржирзНржп
      const urlParams = new URLSearchParams(window.location.search);
      const subjectParam = urlParams.get('subject');
      if (subjectParam) {
        showSubjectPage(subjectParam);
      }
    });
  </script>
</body>
</html>
